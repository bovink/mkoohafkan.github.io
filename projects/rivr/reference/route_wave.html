<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Flood wave routing — route_wave â€¢ rivr</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">


<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>

<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rivr</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../articles/quickstart.html">Quickstart</a>
</li>
<li>
  <a href="../articles/technical-vignette.html">Technical Reference</a>
</li>
<li>
  <a href="../reference/index.html">Function Reference</a>
</li>
<li>
  <a href="../articles/publication-reproduction.html">Publication</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="https://github.com/mkoohafkan/rivr">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

      <div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Flood wave routing</h1>
    </div>

    
    <p>Route a flood wave down a prismatic channel.</p>
    

    <pre class="usage"><span class='fu'>route_wave</span>(<span class='no'>So</span>, <span class='no'>n</span>, <span class='no'>Cm</span>, <span class='no'>g</span>, <span class='no'>B</span>, <span class='no'>SS</span>, <span class='no'>initial.condition</span>, <span class='no'>boundary.condition</span>,
  <span class='no'>downstream.condition</span>, <span class='no'>timestep</span>, <span class='no'>spacestep</span>, <span class='no'>numnodes</span>, <span class='no'>monitor.nodes</span>,
  <span class='no'>monitor.times</span>, <span class='kw'>engine</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"Dynamic"</span>, <span class='st'>"Kinematic"</span>),
  <span class='kw'>scheme</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"MacCormack"</span>, <span class='st'>"Lax"</span>), <span class='kw'>boundary.type</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='st'>"QQ"</span>, <span class='st'>"Qy"</span>, <span class='st'>"yQ"</span>,
  <span class='st'>"yy"</span>))</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a> Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>So</th>
      <td><p>Channel slope [\(L L^{-1}\)].</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>Manning's roughness coefficient.</p></td>
    </tr>
    <tr>
      <th>Cm</th>
      <td><p>Unit conversion coefficient for Manning's equation. For SI units, Cm = 1.</p></td>
    </tr>
    <tr>
      <th>g</th>
      <td><p>Gravitational acceleration [\(L T^{-2}\)].</p></td>
    </tr>
    <tr>
      <th>B</th>
      <td><p>Channel bottom width [\(L\)].</p></td>
    </tr>
    <tr>
      <th>SS</th>
      <td><p>Channel sideslope [\(L L^{-1}\)].</p></td>
    </tr>
    <tr>
      <th>initial.condition</th>
      <td><p>The initial flow rate [\(L^3 T^{-1}\)], assumed constant 
throughout the channel.</p></td>
    </tr>
    <tr>
      <th>boundary.condition</th>
      <td><p>Vector specifying the upstream boundary condition 
for the full duration of the model. If <code>engine = "Kinematic"</code>, values are 
assumed to be flow [\(L^3 T^{-1}\)]. If <code>engine = "Dynamic"</code>, the form of the 
boundary condition is determined by the argument <code>boundary.type</code>.</p></td>
    </tr>
    <tr>
      <th>downstream.condition</th>
      <td><p>Only used if <code>engine = "Dynamic"</code>. Vector specifying 
the upstream boundary condition for the full duration of the model. Must be the same
length as <code>boundary.condition</code>.</p></td>
    </tr>
    <tr>
      <th>timestep</th>
      <td><p>Temporal resolution of the model. Also the assumed time interval [\(T\)] 
between elements of <code>boundary.condition</code> and <code>downstream.condition</code>. 
The user is responsible for ensuring numerical stability.</p></td>
    </tr>
    <tr>
      <th>spacestep</th>
      <td><p>the spatial resolution of the model, interpreted as the distance [\(L\)]
between nodes in the model domain. The user is responsible for ensuring numerical stability.</p></td>
    </tr>
    <tr>
      <th>numnodes</th>
      <td><p>The number of nodes used to discretize the channel. The total channel extent is
computed as <code>spacestep*(numnodes - 1)</code>.</p></td>
    </tr>
    <tr>
      <th>monitor.nodes</th>
      <td><p>the nodes to be monitored every time step. Specified as a vector of node 
indices, with 1 being the upstream boundary and <code>numnodes</code> being the downstream boundary.</p></td>
    </tr>
    <tr>
      <th>monitor.times</th>
      <td><p>the time steps at which to monitor every node. Specified as a vector of 
indices of <code>boundary.condition</code>. Defaults to five equally-spaced time steps including 
the first and last time steps.</p></td>
    </tr>
    <tr>
      <th>engine</th>
      <td><p>The engine to be used for routing the flood wave. 
May be either "Kinematic" or "Dynamic".</p></td>
    </tr>
    <tr>
      <th>scheme</th>
      <td><p>Only used if <code>engine = "Dynamic"</code>. Specifies whether to use the 
Lax Diffusive scheme or the MacCormack predictor-corrector scheme.</p></td>
    </tr>
    <tr>
      <th>boundary.type</th>
      <td><p>Only used if <code>engine = "Dynamic"</code>. Specifies what boundary data
is supplied. Possible characters are If <code>boundary.type = "QQ"</code>, both <code>boundary.condition</code>
and <code>downstream.condition</code> are assumed to be flows [\(L^3 T^{-1}\)]. If 
<code>boundary.type = "Qy"</code> the upstream boundary is assumed to be flow
while the downstream boundary is assumed to be depth [\(L\)]. Other possibilities
are <code>"yQ"</code> and <code>"yy"</code>.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>data.frame with columns:</p>
<dt>step</dt><dd><p>Time step.</p></dd>
  <dt>node</dt><dd><p>Node index.</p></dd>
  <dt>time</dt><dd><p>Time since start.</p></dd>
  <dt>distance</dt><dd><p>Downstream distance.</p></dd>
  <dt>flow</dt><dd><p>Flow rate.</p></dd>
  <dt>depth</dt><dd><p>Flow depth.</p></dd>
  <dt>velocity</dt><dd><p>Flow velocity.</p></dd>
  <dt>area</dt><dd><p>Flow area.</p></dd>
  <dt>monitor.type</dt><dd><p>Row refers to a monitored node ("node") or timestep ("timestep").</p></dd>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Provides implementations of a Kinematic Wave Model (KWM) and 
  a Dynamic Wave Model (DWM) with the choice of two numerical schemes. The MacCormack 
  scheme is a second-order accurate predictor-corrector scheme that provides efficient 
  flood wave routing. The Lax diffusive scheme can be used to obtain smooth solutions for
  problems with discontinuities in the boundary conditions, e.g. sudden gate closures.
  The DWM implementation uses the Method of Characteristics (MOC) to compute the flow 
  regime at the model boundaries, and allows the user to specify boundaries in terms of 
  depths and/or flows. the KWM implementation assumes the normal depth at the upstream
  boundary and is only first-order accurate.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>not_run</span>({

  <span class='co'># kinematic wave routing</span>
  <span class='no'>times</span> <span class='kw'>=</span> <span class='fu'>seq</span>(<span class='fl'>0</span>, <span class='fl'>30000</span>, <span class='kw'>by</span> <span class='kw'>=</span> <span class='fl'>25</span>)
  <span class='no'>floodwave</span> <span class='kw'>=</span> <span class='fu'>ifelse</span>(<span class='no'>times</span> <span class='kw'>&gt;=</span> <span class='fl'>9000</span>, <span class='fl'>250</span>,
    <span class='fl'>250</span> + (<span class='fl'>750</span>/<span class='no'>pi</span>)*(<span class='fl'>1</span> - <span class='fu'>cos</span>(<span class='no'>pi</span>*<span class='no'>times</span>/(<span class='fl'>60</span>*<span class='fl'>75</span>))))
  <span class='fu'>route_wave</span>(<span class='fl'>0.001</span>, <span class='fl'>0.045</span>, <span class='fl'>1.486</span>, <span class='fl'>32.2</span>, <span class='fl'>100</span>, <span class='fl'>0</span>, <span class='kw'>initial.condition</span> <span class='kw'>=</span> <span class='fl'>250</span>,
    <span class='kw'>boundary.condition</span> <span class='kw'>=</span> <span class='no'>floodwave</span>, <span class='kw'>timestep</span> <span class='kw'>=</span> <span class='fl'>25</span>, <span class='kw'>spacestep</span> <span class='kw'>=</span> <span class='fl'>50</span>,
    <span class='kw'>numnodes</span><span class='kw'>=</span><span class='fl'>301</span>, <span class='kw'>monitor.nodes</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>101</span>, <span class='fl'>201</span>, <span class='fl'>301</span>),
    <span class='kw'>monitor.times</span> <span class='kw'>=</span> <span class='fu'>seq</span>(<span class='fl'>1</span>, <span class='fu'>length</span>(<span class='no'>times</span>), <span class='kw'>by</span> <span class='kw'>=</span> <span class='fl'>10</span>), <span class='kw'>engine</span> <span class='kw'>=</span> <span class='st'>"Kinematic"</span>)
  <span class='co'># dynamic wave routing with zero-gradient downstream condition using MacCormack scheme</span>
  <span class='fu'>route_wave</span>(<span class='fl'>0.001</span>, <span class='fl'>0.045</span>, <span class='fl'>1.486</span>, <span class='fl'>32.2</span>, <span class='fl'>100</span>, <span class='fl'>0</span>, <span class='kw'>initial.condition</span> <span class='kw'>=</span> <span class='fl'>250</span>,
    <span class='kw'>boundary.condition</span> <span class='kw'>=</span> <span class='no'>floodwave</span>, <span class='kw'>downstream.condition</span> <span class='kw'>=</span> <span class='fu'>rep</span>(-<span class='fl'>1</span>, <span class='fu'>length</span>(<span class='no'>times</span>)),
    <span class='kw'>timestep</span> <span class='kw'>=</span> <span class='fl'>25</span>, <span class='kw'>spacestep</span> <span class='kw'>=</span> <span class='fl'>500</span>, <span class='kw'>numnodes</span> <span class='kw'>=</span> <span class='fl'>31</span>, <span class='kw'>engine</span> <span class='kw'>=</span> <span class='st'>"Dynamic"</span>,
    <span class='kw'>scheme</span> <span class='kw'>=</span> <span class='st'>"MacCormack"</span>, <span class='kw'>monitor.nodes</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>11</span>, <span class='fl'>21</span>, <span class='fl'>31</span>),
    <span class='kw'>monitor.times</span> <span class='kw'>=</span> <span class='fu'>seq</span>(<span class='fl'>1</span>, <span class='fu'>length</span>(<span class='no'>times</span>), <span class='kw'>by</span> <span class='kw'>=</span> <span class='fl'>10</span>))
  <span class='co'># mixed boundary conditions (sudden gate closure) using Lax scheme</span>
  <span class='no'>lax</span> <span class='kw'>=</span> <span class='fu'>route_wave</span>(<span class='fl'>0.00008</span>, <span class='fl'>0.013</span>, <span class='fl'>1</span>, <span class='fl'>9.81</span>, <span class='fl'>6.1</span>, <span class='fl'>1.5</span>,
    <span class='kw'>initial.condition</span> <span class='kw'>=</span> <span class='fl'>126</span>, <span class='kw'>boundary.condition</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>5.79</span>, <span class='fl'>2001</span>),
    <span class='kw'>downstream.condition</span> <span class='kw'>=</span> <span class='fu'>rep</span>(<span class='fl'>0</span>, <span class='fl'>2001</span>), <span class='kw'>timestep</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>spacestep</span> <span class='kw'>=</span> <span class='fl'>10</span>,
    <span class='kw'>numnodes</span> <span class='kw'>=</span> <span class='fl'>501</span>, <span class='kw'>monitor.nodes</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>151</span>, <span class='fl'>251</span>, <span class='fl'>301</span>, <span class='fl'>501</span>),
    <span class='kw'>monitor.times</span> <span class='kw'>=</span> <span class='fu'>c</span>(<span class='fl'>1</span>, <span class='fl'>501</span>, <span class='fl'>1001</span>, <span class='fl'>1501</span>, <span class='fl'>2001</span>),
    <span class='kw'>engine</span><span class='kw'>=</span><span class='st'>"Dynamic"</span>, <span class='kw'>scheme</span><span class='kw'>=</span><span class='st'>"Lax"</span>, <span class='kw'>boundary.type</span><span class='kw'>=</span><span class='st'>"yQ"</span>)
  <span class='co'># extract data for a monitored point</span>
  <span class='fu'>require</span>(<span class='no'>dplyr</span>)
  <span class='fu'>filter</span>(<span class='no'>lax</span>, <span class='no'>monitor.type</span> <span class='kw'>==</span> <span class='st'>"node"</span>, <span class='no'>node</span> <span class='kw'>==</span> <span class='fl'>151</span>)
})</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Michael Koohafkan.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  </body>
</html>
